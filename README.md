# desktopshowbraverewards
  ; insert the document name structure into the document structure     DllStructSetData($strDoc, "DocName", DllStructGetPtr($strDocNm))     DllCall("gdi32.dll", "long", "StartDoc", "hwnd", $hPrintDc, "ptr", DllStructGetPtr($strDoc))      ; -----------------------------------------------------------     ; make a loop to format each printed page and exit when     ; $cpMin reaches the $cpMax     ; $cpMin is less than 0---{I have seen -1 but I forget when}---     ; ALSO-- ExitLoop if $cpMin = $cpMin 2---if it stops finding the start of next page     Local $StartPage, $EndPage     #forceref $StartPage     While $cpMax > $cpMin And $cpMin > -1          ; start a new page-----------         $StartPage = DllCall("Gdi32.dll", "int", "StartPage", "HANDLE", $hPrintDc)          ; increment page the count-----------         ; if not done now it will exit the loop before counting the last page         ; get the 1st char of the next page, {but how does it work ???}         $cpMin2 = $cpMin         $cpMin = _SendMessage($hRichEditCtrl, $EM_FORMATRANGE, True, DllStructGetPtr($strcPage))          ; ExitLoop when $cpMin = $cpMin 2---just in case it stops finding the start of next page         If $cpMin2 = $cpMin Then ExitLoop; get out of loop before more pages are added          ; set the next page start char-----------         DllStructSetData($strcPage, "cpMin", $cpMin)          ; this sends it to the printer         $EndPage = DllCall("Gdi32.dll", "int", "EndPage", "HANDLE", $hPrintDc)          ; end the page and loop again for the next page until the end of document     WEnd     _SendMessage($hRichEditCtrl, $EM_FORMATRANGE, False, 0)     If $EndPage[0] > 0 Then         DllCall("Gdi32.dll", "int", "EndDoc", "HANDLE", $hPrintDc)         Return 'Sent to the printer.'     Else         DllCall("Gdi32.dll", "int", "AbortDoc", "HANDLE", $hPrintDc)         Return 'Printing aborted.'     EndIf EndFunc   ;==>__RTF_Print #EndRegion RTF PRINTER INTERNAL#  #Region MSDN Links , Help, Doc ;~ How to Print the Contents of Rich Edit Controls ;~ http://msdn.microsoft.com/en-us/library/windows/desktop/bb787875(v=vs.85).aspx ;~ http://blogs.msdn.com/b/oldnewthing/archive/2007/01/12/1455972.aspx  ;~ How To Use GetDeviceCaps to Determine Margins on a Page ;~ http://support.microsoft.com/kb/193943   ;~ http://msdn.microsoft.com/en-us/library/windows/desktop/dd144877(v=vs.85).aspx ;~ http://msdn.microsoft.com/en-us/library/windows/desktop/dd162833(v=vs.85).aspx ;~ http://msdn.microsoft.com/en-us/library/windows/desktop/dd162931(v=vs.85).aspx ;~ http://support.microsoft.com/kb/139652 ;~ http://msdn.microsoft.com/en-us/library/windows/desktop/ms646962(v=vs.85).aspx ;~ http://msdn.microsoft.com/en-us/library/windows/desktop/ms646964(v=vs.85).aspx ;~ http://msdn.microsoft.com/en-us/library/windows/desktop/ms646966(v=vs.85).aspx  #EndRegion MSDN Links , Help, Doc
